---
layout: default
---

{% assign collection_name = page.collection | default: page.collection_name %}
{% assign sort_key = page.collection_sort_key | default: 'order' %}
{% if page.collection_path %}
  {% if page.collection_name %}
    {% assign base = site[page.collection_name] %}
  {% elsif page.lang == "en" %}
    {% assign base = site.posts_en %}
  {% else %}
    {% assign base = site.posts %}
  {% endif %}
  {% assign collection_items = base | where_exp: 'p', 'p.path contains page.collection_path' | sort: sort_key %}
{% else %}
  {% assign collection_items = site[collection_name] | sort: sort_key %}
{% endif %}
{% if page.collection_label %}
  {% assign collection_label = page.collection_label %}
{% else %}
  {% assign collection_label = collection_name | replace: '_', ' ' | capitalize %}
{% endif %}

<article class="guide-wrapper">
  <aside class="guide-sidebar">
    <h2 class="guide-sidebar-title">{{ collection_label }}</h2>
    <ol class="guide-chapter-list">
      {% for entry in collection_items %}
      <li class="guide-chapter-item{% if entry.url == page.url %} is-active{% endif %}">
        <a href="{{ entry.url | relative_url }}">{{ entry.title }}</a>
      </li>
      {% endfor %}
    </ol>
  </aside>

  <section class="guide-content">
    <header class="guide-content-header">
      <h1>{{ page.title }}</h1>
      {% if page.date %}
      <p class="guide-meta">{{ page.date | date: "%Y.%m.%d" }}</p>
      {% endif %}
    </header>
    <div class="guide-markdown">
      {{ content }}
    </div>

    {% if collection_items %}
    <nav class="guide-prev-next">
      {% assign prev_entry = nil %}
      {% assign next_entry = nil %}
      {% for entry in collection_items %}
        {% if entry.url == page.url %}
          {% assign next_index = forloop.index0 | plus: 1 %}
          {% if next_index < collection_items.size %}
            {% assign next_entry = collection_items[next_index] %}
          {% endif %}
          {% break %}
        {% endif %}
        {% assign prev_entry = entry %}
      {% endfor %}

      {% if prev_entry %}
        <a class="guide-nav-link prev" href="{{ prev_entry.url | relative_url }}">
          ← {{ prev_entry.title }}
        </a>
      {% else %}
        <span class="guide-nav-link prev is-disabled">← 이전 글 없음</span>
      {% endif %}

      {% if next_entry %}
        <a class="guide-nav-link next" href="{{ next_entry.url | relative_url }}">
          {{ next_entry.title }} →
        </a>
      {% else %}
        <span class="guide-nav-link next is-disabled">다음 글 없음 →</span>
      {% endif %}
    </nav>
    {% endif %}
  </section>
</article>
